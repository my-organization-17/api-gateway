syntax = "proto3";

package menu_category.v1;

import "google/protobuf/timestamp.proto";
import "menu-item.proto";

// MenuCategoryService defines the gRPC service for managing menu categories.
service MenuCategoryService {
  // rpc to get full menu by language
  rpc GetFullMenuByLanguage(Language) returns (FullMenuResponse) {}
  // rpc to get menu categories by language
  rpc GetMenuCategoriesByLanguage(Language) returns (MenuCategoryListWithTranslation) {}
  // rpc to get a menu category by its ID
  rpc GetMenuCategoryById(Id) returns (MenuCategoryWithTranslation) {}
  // rpc to create a new menu category
  rpc CreateMenuCategory(CreateMenuCategoryRequest) returns (MenuCategory) {}
  // rpc to update an existing menu category
  rpc UpdateMenuCategory(UpdateMenuCategoryRequest) returns (MenuCategory) {}
  // rpc to change the position of a menu category
  rpc ChangeMenuCategoryPosition(ChangeMenuCategoryPositionRequest) returns (MenuCategory) {}
  // rpc to delete a menu category by its ID
  rpc DeleteMenuCategory(Id) returns (StatusResponse) {}
  // rpc to create a new category translation
  rpc CreateMenuCategoryTranslation(CreateMenuCategoryTranslationRequest) returns (MenuCategoryTranslation) {}
  // rpc to update an existing category translation
  rpc UpdateMenuCategoryTranslation(UpdateMenuCategoryTranslationRequest) returns (MenuCategoryTranslation) {}
  // rpc to delete a category translation by its ID
  rpc DeleteMenuCategoryTranslation(Id) returns (StatusResponse) {}
}

// declaration of Language message
message Language {
  string language = 1;
}

// declaration of Id message
message Id {
  string id = 1;
}

// Message representing a list of menu categories with translations
message MenuCategoryListWithTranslation {
  repeated MenuCategoryWithTranslation data = 1;
}

// Message representing a menu category
message MenuCategory {
  string id = 1;
  string slug = 2;
  int32 position = 3;
  optional string image_url = 4;
  bool is_available = 5;
  google.protobuf.Timestamp created_at = 6;
  google.protobuf.Timestamp updated_at = 7;
}

// Message representing full menu response with categories and items
message FullMenuResponse {
  repeated FlatMenuCategoryWithItems categories = 1;
}

// Message representing a menu category translation
message MenuCategoryTranslation {
  string id = 1;
  string language = 2;
  string title = 3;
  optional string description = 4;
}

// Message representing a menu category with translation
message MenuCategoryWithTranslation {
  string id = 1;
  string slug = 2;
  int32 position = 3;
  optional string image_url = 4;
  bool is_available = 5;
  repeated MenuCategoryTranslation translations = 6;
}

// Message representing a menu category with items
message MenuCategoryWithItems {
  string id = 1;
  string slug = 2;
  int32 position = 3;
  optional string image_url = 4;
  bool is_available = 5;
  repeated MenuCategoryTranslation translations = 6;
  repeated menu_item.v1.MenuItemWithTranslation menu_items = 7;
}

// Message representing a flat menu category with items for a specific language
message FlatMenuCategoryWithItems {
  string id = 1;
  string slug = 2;
  int32 position = 3;
  bool is_available = 4;
  string language = 5;
  string title = 6;
  optional string description = 7;
  optional string image_url = 8;
  repeated menu_item.v1.FlatMenuItemWithTranslation menu_items = 9;
}

// Request message for creating a menu category.
message CreateMenuCategoryRequest {
  string slug = 1;
  optional string image_url = 2;
  optional bool is_available = 3;
}
// Request message for updating a menu category.
message UpdateMenuCategoryRequest {
  string id = 1;
  optional string slug = 2;
  optional string image_url = 3;
  optional bool is_available = 4;
}
// Request message for changing the position of a menu category.
message ChangeMenuCategoryPositionRequest {
  string id = 1;
  int32 position = 2;
}

// Request message for creating a menu category translation.
message CreateMenuCategoryTranslationRequest {
  string category_id = 1;
  string language = 2;
  string title = 3;
  optional string description = 4;
}

// Request message for updating a menu category translation.
message UpdateMenuCategoryTranslationRequest {
  string id = 1;
  optional string title = 2;
  optional string description = 3;
}

// Message representing a status response
message StatusResponse {
  bool success = 1;
  string message = 2;
}

// Command to generate TypeScript code with NestJS options
// protoc -I ./proto ./proto/menu-category.proto --ts_proto_out=./src/generated-types --ts_proto_opt=nestJs=true

// Command to generate TypeScript code with NestJS options, using null for optional fields and Date for timestamps
// protoc -I ./proto ./proto/menu-category.proto --ts_proto_out=./src/generated-types --ts_proto_opt=nestJs=true --ts_proto_opt=useNullAsOptional=true --ts_proto_opt=useDate=true
